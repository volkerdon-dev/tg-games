<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TG Chess</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div>
        <h1 class="app-title" data-i18n="home.title">â™Ÿï¸ TG Chess</h1>
        <p class="app-subtitle" data-i18n="home.subtitle">Play, learn, train â€” your daily chess studio</p>
      </div>
      <div class="app-actions">
        <a class="icon-btn" href="./settings/index.html" data-i18n="nav.settings">Settings</a>
      </div>
    </header>

    <main class="app-content">
      <div class="container">
        <section class="section home-primary">
          <a class="card primary-card" id="continueCard" href="./chess/index.html">
            <div class="primary-card-main">
              <div>
                <h2 class="primary-title" id="continueTitle" data-i18n="home.continue.title.resume">Continue</h2>
                <p class="primary-subtitle" id="continueSubtitle" data-i18n="home.continue.subtitle.resume">Resume your last activity</p>
              </div>
              <span class="btn primary-cta" id="continueCta" data-i18n="home.continue.cta">Open</span>
            </div>
          </a>
        </section>

        <section class="section">
          <div class="mode-grid">
            <a class="card mode-tile" href="./chess/index.html">
              <h3 class="mode-title"><span class="mode-icon">â™Ÿï¸</span><span data-i18n="home.mode.play.title">Play</span></h3>
              <p class="mode-subtitle" data-i18n="home.mode.play.subtitle">Quick game vs AI</p>
            </a>
            <a class="card mode-tile" href="./learn/index.html">
              <h3 class="mode-title"><span class="mode-icon">ğŸ“š</span><span data-i18n="home.mode.learn.title">Learn</span></h3>
              <p class="mode-subtitle" data-i18n="home.mode.learn.subtitle">Guided lessons</p>
            </a>
            <a class="card mode-tile" href="./train/index.html">
              <h3 class="mode-title"><span class="mode-icon">ğŸ¯</span><span data-i18n="home.mode.train.title">Train</span></h3>
              <p class="mode-subtitle" data-i18n="home.mode.train.subtitle">Tactical drills</p>
            </a>
          </div>
        </section>
      </div>
    </main>

    <nav class="bottom-nav">
      <a class="nav-item" href="./chess/index.html">â™Ÿï¸<span data-i18n="nav.play">Play</span></a>
      <a class="nav-item" href="./learn/index.html">ğŸ“š<span data-i18n="nav.learn">Learn</span></a>
      <a class="nav-item" href="./train/index.html">ğŸ¯<span data-i18n="nav.train">Train</span></a>
      <a class="nav-item" href="./progress/index.html">ğŸ“ˆ<span data-i18n="nav.progress">Progress</span></a>
    </nav>
  </div>

  <script type="module">
    import { initTelegram } from "./shared/telegram.js";
    import { loadState, touch } from "./shared/storage.js";
    import { getLastRoute } from "./shared/last-activity.js";
    import { setText } from "./shared/ui.js";
    import { applyI18n, getLang, loadDict, t } from "./shared/i18n.js";

    initTelegram();
    const state = loadState();
    touch(state);

    await loadDict(getLang());
    await applyI18n();

    const lastRoute = getLastRoute();
    const continueHref = lastRoute || "/chess/index.html";
    const isResume = Boolean(lastRoute);

    const titleKey = isResume ? "home.continue.title.resume" : "home.continue.title.start";
    const subtitleKey = isResume ? "home.continue.subtitle.resume" : "home.continue.subtitle.start";

    const continueCard = document.getElementById("continueCard");
    if (continueCard) {
      continueCard.setAttribute("href", continueHref);
    }
    setText("continueTitle", t(titleKey));
    setText("continueSubtitle", t(subtitleKey));
    setText("continueCta", t("home.continue.cta"));
  </script>
</body>
</html>
